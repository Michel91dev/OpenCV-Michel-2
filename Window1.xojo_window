#tag DesktopWindow
Begin DesktopWindow Window1
   Backdrop        =   0
   BackgroundColor =   &c99B9BD00
   Composite       =   False
   DefaultLocation =   0
   FullScreen      =   False
   HasBackgroundColor=   True
   HasCloseButton  =   True
   HasFullScreenButton=   False
   HasMaximizeButton=   True
   HasMinimizeButton=   True
   Height          =   785
   ImplicitInstance=   True
   MacProcID       =   0
   MaximumHeight   =   32000
   MaximumWidth    =   32000
   MenuBar         =   12507135
   MenuBarVisible  =   True
   MinimumHeight   =   64
   MinimumWidth    =   64
   Resizeable      =   True
   Title           =   "Window1"
   Type            =   0
   Visible         =   True
   Width           =   914
   Begin DeskTopLabel Label1
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   32
      Index           =   -2147483648
      Italic          =   False
      Left            =   9
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Video Freq"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   204
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel Label_Video_Msg
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   52
      Index           =   -2147483648
      Italic          =   False
      Left            =   121
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   True
      Scope           =   2
      Selectable      =   True
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Messages"
      TextAlignment   =   0
      TextColor       =   &c000000
      Tooltip         =   ""
      Top             =   148
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   236
   End
   Begin DeskTopGroupBox GroupBox4_Scroll_OffSet
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Scroll OffSet"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   66
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   542
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   43
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   44
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   102
   End
   Begin DeskTopGroupBox GroupBox2
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Canny Edge Detection"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   66
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   102
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   33
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "Use Slider to play"
      Top             =   44
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   216
   End
   Begin DeskTopGroupBox GroupBox1
      AllowAutoDeactivate=   True
      Bold            =   False
      Caption         =   "Scale Image (or Use + and -)"
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   66
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   330
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   25
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   44
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   211
   End
   Begin DesktopButton bLoad
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Select Image"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   20
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   0
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   12
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   108
   End
   Begin DeskTopLabel Label_ImageName
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   12.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   155
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   1
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "No image loaded"
      TextAlignment   =   0
      TextColor       =   &c32356600
      Tooltip         =   ""
      Top             =   12
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   617
   End
   Begin DesktopButton bBlur
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Blur"
      Default         =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   656
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   4
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   44
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopButton Button_Ma_Video
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Detect Faces or Eyes from WebCam"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   9
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   7
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   432
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   256
   End
   Begin DesktopCanvas Canvas_Image
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      Enabled         =   True
      Height          =   544
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   444
      LockBottom      =   True
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   True
      LockTop         =   True
      Scope           =   2
      TabIndex        =   11
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   221
      Transparent     =   True
      Visible         =   True
      Width           =   450
   End
   Begin DesktopButton button_CVCFloatVector
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "CVCFloatVector"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   13
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   12
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   504
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   171
   End
   Begin DesktopButton bFaces
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Faces"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   13
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   13
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   553
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopPopupMenu ImagesFileList_PopupMenu
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      InitialValue    =   ""
      Italic          =   False
      Left            =   105
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      SelectedRowIndex=   0
      TabIndex        =   14
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   554
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   340
   End
   Begin DeskTopLabel lblFaces
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   13
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   15
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   585
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   264
   End
   Begin DesktopButton bSobel
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Sobel (imRead)"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   52
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   9
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   16
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   620
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   118
   End
   Begin DesktopSlider sobelParam
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   False
      Enabled         =   True
      Height          =   23
      Index           =   0
      InitialParent   =   ""
      Left            =   164
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   20
      MinimumValue    =   1
      PageStep        =   20
      Scope           =   2
      TabIndex        =   17
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   0
      Tooltip         =   ""
      Top             =   617
      Transparent     =   False
      Value           =   1
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel tSobleParam
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   0
      InitialParent   =   ""
      Italic          =   False
      Left            =   276
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   18
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   617
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   74
   End
   Begin DesktopSlider sobelParam
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   False
      Enabled         =   True
      Height          =   23
      Index           =   1
      InitialParent   =   ""
      Left            =   164
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   20
      MinimumValue    =   1
      PageStep        =   20
      Scope           =   2
      TabIndex        =   19
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   0
      Tooltip         =   ""
      Top             =   649
      Transparent     =   False
      Value           =   1
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel tSobleParam
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   1
      InitialParent   =   ""
      Italic          =   False
      Left            =   276
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   20
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   649
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   74
   End
   Begin DesktopSlider sobelParam
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   False
      Enabled         =   True
      Height          =   23
      Index           =   2
      InitialParent   =   ""
      Left            =   164
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   20
      MinimumValue    =   0
      PageStep        =   20
      Scope           =   2
      TabIndex        =   21
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   0
      Tooltip         =   ""
      Top             =   681
      Transparent     =   False
      Value           =   0
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel tSobleParam
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   2
      InitialParent   =   ""
      Italic          =   False
      Left            =   276
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   22
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Untitled"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   681
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   74
   End
   Begin DesktopSlider Slider_Resize
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   True
      Enabled         =   True
      Height          =   23
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   344
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   150
      MinimumValue    =   1
      PageStep        =   20
      Scope           =   2
      TabIndex        =   24
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   1
      Tooltip         =   ""
      Top             =   77
      Transparent     =   False
      Value           =   100
      Visible         =   True
      Width           =   186
   End
   Begin DesktopButton Button_Gray
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Gris"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   656
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   26
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   73
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopSlider Slider_threshold1
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   True
      Enabled         =   True
      Height          =   23
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   112
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   250
      MinimumValue    =   1
      PageStep        =   20
      Scope           =   2
      TabIndex        =   28
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   0
      Tooltip         =   ""
      Top             =   73
      Transparent     =   False
      Value           =   1
      Visible         =   True
      Width           =   100
   End
   Begin DesktopSlider Slider_threshold2
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   True
      Enabled         =   True
      Height          =   23
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   211
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   250
      MinimumValue    =   1
      PageStep        =   20
      Scope           =   2
      TabIndex        =   29
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   0
      Tooltip         =   ""
      Top             =   73
      Transparent     =   False
      Value           =   54
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel Label_Threshold1
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   140
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   31
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Threshold1"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   84
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel Label_Threshold2
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   240
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   32
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Threshold2"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   84
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   100
   End
   Begin DeskTopLabel Label_KeyPressed
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   8.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   True
      Left            =   840
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   41
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "KeyPressed"
      TextAlignment   =   0
      TextColor       =   &c32356600
      Tooltip         =   ""
      Top             =   0
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   79
   End
   Begin DesktopSlider Slider_Scroll_Offset
      AllowAutoDeactivate=   True
      AllowLiveScrolling=   True
      Enabled         =   True
      Height          =   23
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   556
      LineStep        =   1
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MaximumValue    =   30
      MinimumValue    =   1
      PageStep        =   20
      Scope           =   2
      TabIndex        =   42
      TabPanelIndex   =   0
      TabStop         =   True
      TickMarkStyle   =   0
      Tooltip         =   ""
      Top             =   77
      Transparent     =   False
      Value           =   10
      Visible         =   True
      Width           =   75
   End
   Begin DeskTopLabel Label_Key
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   8.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   True
      Left            =   784
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   44
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Key pressed"
      TextAlignment   =   0
      TextColor       =   &c5C63B700
      Tooltip         =   ""
      Top             =   0
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   54
   End
   Begin DeskTopLabel Label_Arrow
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   330
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Multiline       =   False
      Scope           =   2
      Selectable      =   False
      TabIndex        =   45
      TabPanelIndex   =   0
      TabStop         =   True
      Text            =   "Use arrows to move the Image"
      TextAlignment   =   0
      TextColor       =   &c00000000
      Tooltip         =   ""
      Top             =   108
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   314
   End
   Begin DesktopCanvas Canvas_Video
      AllowAutoDeactivate=   True
      AllowFocus      =   False
      AllowFocusRing  =   True
      AllowTabs       =   False
      Backdrop        =   0
      Enabled         =   True
      Height          =   164
      Index           =   -2147483648
      InitialParent   =   ""
      Left            =   13
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      TabIndex        =   49
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   "pour la capture video"
      Top             =   236
      Transparent     =   True
      Visible         =   True
      Width           =   312
   End
   Begin Timer Timer_Video_‚è∞
      Enabled         =   True
      Index           =   -2147483648
      LockedInPosition=   False
      Period          =   8
      RunMode         =   2
      Scope           =   2
      TabPanelIndex   =   0
   End
   Begin DesktopRadioGroup RadioGroup_ImageAction
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   False
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   164
      Horizontal      =   False
      Index           =   -2147483648
      InitialValue    =   "None\nBlur\nGray\nCanny Edge Detection\nAbs Diff"
      Italic          =   False
      Left            =   323
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedIndex   =   0
      TabIndex        =   53
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   236
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   189
   End
   Begin DesktopBevelButton BevelButton_CameraActivated
      Active          =   False
      AllowAutoDeactivate=   False
      AllowFocus      =   False
      AllowTabStop    =   True
      BackgroundColor =   &cFF260000
      BevelStyle      =   2
      Bold            =   False
      ButtonStyle     =   1
      Caption         =   "Webcam "
      CaptionAlignment=   3
      CaptionDelta    =   0
      CaptionPosition =   1
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      HasBackgroundColor=   True
      Height          =   61
      Icon            =   0
      IconAlignment   =   1
      IconDeltaX      =   0
      IconDeltaY      =   0
      Index           =   -2147483648
      InitialParent   =   ""
      Italic          =   False
      Left            =   470
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MenuStyle       =   0
      PanelIndex      =   0
      Scope           =   2
      TabIndex        =   54
      TabPanelIndex   =   0
      TextColor       =   &c0035FF00
      Tooltip         =   "Activates the Webcam"
      Top             =   148
      Transparent     =   False
      Underline       =   False
      Value           =   False
      Visible         =   True
      Width           =   194
      _mIndex         =   0
      _mInitialParent =   ""
      _mName          =   ""
      _mPanelIndex    =   0
   End
   Begin DesktopButton Button_V_ORG
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Video"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   9
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   55
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   464
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   80
   End
   Begin DesktopButton Button_FacesFromFile
      AllowAutoDeactivate=   True
      Bold            =   False
      Cancel          =   False
      Caption         =   "Detect Faces and Eyes from File"
      Default         =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   20
      Index           =   -2147483648
      Italic          =   False
      Left            =   9
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      MacButtonStyle  =   0
      Scope           =   2
      TabIndex        =   56
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   400
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   256
   End
   Begin DesktopRadioGroup WebCam_Num
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   61
      Horizontal      =   False
      Index           =   -2147483648
      InitialValue    =   "0\n1\n2"
      Italic          =   False
      Left            =   676
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   2
      SelectedIndex   =   0
      TabIndex        =   57
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   148
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   111
   End
   Begin DesktopRadioGroup RadioGroup1
      AllowAutoDeactivate=   True
      Bold            =   False
      Enabled         =   True
      FontName        =   "System"
      FontSize        =   0.0
      FontUnit        =   0
      Height          =   45
      Horizontal      =   False
      Index           =   -2147483648
      InitialValue    =   "Option 1\rOption 2"
      Italic          =   False
      Left            =   60
      LockBottom      =   False
      LockedInPosition=   False
      LockLeft        =   True
      LockRight       =   False
      LockTop         =   True
      Scope           =   0
      SelectedIndex   =   0
      TabIndex        =   58
      TabPanelIndex   =   0
      TabStop         =   True
      Tooltip         =   ""
      Top             =   60
      Transparent     =   False
      Underline       =   False
      Visible         =   True
      Width           =   100
   End
End
#tag EndDesktopWindow

#tag WindowCode
	#tag Event
		Function KeyDown(key As String) As Boolean
		  // //P 90 LanguageReference 2017 Mike
		  
		  Label_KeyPressed.Text = Str( Asc (Key) )
		  
		  
		  Select Case Asc(Key)
		    
		  Case 31 'up arrow
		    yZoom = yZoom - Slider_Scroll_Offset.Value
		    // if yZoom <0 Then // si je veux emp√™cher le d√©filement avant le bord haut
		    // yZoom = 0
		    // End If
		    
		  Case 28 'Right arrow
		    xZoom = xZoom + Slider_Scroll_Offset.Value
		    
		  Case 30 'Down arrow
		    yZoom = yZoom + Slider_Scroll_Offset.Value
		    
		    
		  Case 29 // Left arrow
		    xZoom = xZoom - Slider_Scroll_Offset.Value
		    // if xZoom <0 Then  // si je veux emp√™cher le d√©filement avant le bord gauche
		    // xZoom = 0
		    // End If
		    
		    // Pilotons le facteur de Zoom au clavier avec "+" et "-"
		  Case 43// 45$ est le code +
		    Slider_Resize.Value = Slider_Resize.Value + 1
		    if Slider_Resize.Value > Slider_Resize.MaximumValue then
		      Slider_Resize.Value = Slider_Resize.MaximumValue
		    End If
		    
		    
		  Case 45 // 45$ est le code -
		    Slider_Resize.Value = Slider_Resize.Value - 1
		    if Slider_Resize.Value < Slider_Resize.MinimumValue then
		      Slider_Resize.Value = Slider_Resize.MinimumValue
		    End If
		    
		    
		  End Select
		  
		  currentImage = currentImage // force the Paint Event of the DesktopCanvas
		  
		  Return True
		End Function
	#tag EndEvent

	#tag Event
		Sub Opening()
		  // Initialisations
		  // Positionnement des fen√™tres
		  
		  Window1.Left = 50
		  Window1.Width =   DesktopDisplay.DisplayAt(0).Width / 1.5
		  
		  Window1.top = Window1.Left
		  Window1.Height = DesktopDisplay.DisplayAt(0).Height  / 1.5 - 2*Window1.top
		  
		  Window_myConsole.Show // for dispalying so Debugging messages
		  Window_myConsole.Left =  Window1.Left + Window1.Width + 50
		  Window_myConsole.Width = DesktopDisplay.DisplayAt(0).Width - Window_myConsole.Left  -5
		  
		  //_______
		  
		  // pour la fonction "Canny Hedges"
		  Slider_threshold1.Value = 1 
		  Slider_threshold2.Value = 80 // assez empirique
		  
		  
		  Var f As  FolderItem
		  f=SpecialFolder.Resource("images").Child("starry_night.jpeg") // ‚ö†Ô∏è Il faudra que je modifie cette obligation de mettre l'image √† plat dans le dossier ~/images  C'est nul
		  
		  myLoadImage(f) // C'est moi qui le rajoute ici comme cela je n'ai pas √† cliquer sur le bouton √† chaque fois
		  ScaleImage = Min ( Canvas_Image.Width / currentImage.Width  ,  Canvas_Image.Height / currentImage.Height ) // Fonction min() int√©ressante
		  
		  faitListeDeFichiers //  lit tout le dossier "images" et ses sous-dossiers et range les noms dans l'objet de la Window1 : DesktopPopupMenu
		  
		  // Slider_Resize.Value = min (Canvas_Image.Width / currentImage.Width , Canvas_Image.Height / currentImage.Height) * 80
		  
		  // ceci figurait en commentaires dans le fichier originel download√© de GitHub
		  'Var f As FolderItem=SpecialFolder.Desktop.Child("prova.png")
		  'Var ok As Boolean=openCV.Codecs.imwrite(f.NativePath, reference)
		  'Break
		  
		  
		  
		  
		  
		  
		  
		End Sub
	#tag EndEvent


	#tag Method, Flags = &h21
		Private Sub faitListeDeFichiers()
		  // Cet algorithme √©tait appel√© √† l'ouverture de Window dans le Handler "Open()" et ralentissait l'ouverture
		  // du logiciel
		  
		  // >> je le d√©place dans une m√©thode
		  
		  
		  // Ceci prend du temps car cet algo appel√© √† chaque fois que le programme se lance semble
		  // lire tout le dossier "images" et ses sous-dossiers
		  // je comprends qu'il fait la liste de tous les fichiers dans images.
		  // Cet algo semble tr√®s optimis√©, je n'ai pas l'habitude des dictionnaires mais cela a l'air tr√®s puissant.
		  
		  
		  
		  imageResourcesDictionary=New Dictionary // voir la doc de Xojo mais c'est une liste de Pair
		  Var fr As FolderItem=SpecialFolder.Resource("images")
		  
		  // pour chaque fichier qui est dans le dossier "images"
		  For Each ff As FolderItem In fr.Children             // ‚ö†Ô∏è le "in" est tr√®s interessant, voir Doc Xojo
		    Var ffile() As String=ff.Name.Split(".")        // Split est aussi tr√®s interessant pour √©clater le str en autant de str d√©limit√© par "." ici
		    If ffile.Count>1 Then ffile.RemoveAt(ffile.LastIndex) // on √©lminite le dernier c'est √† dire ce qui suit le . dans le nom de dossier
		    imageResourcesDictionary.Value(String.FromArray(ffile, ".").Lowercase)=ff.NativePath // Assigns a value to a String variable by concatenating the elements of a one-dimensional String array. - popule le dictionnaire avec le chemin du fichier
		  Next
		  Var k() As Variant=imageResourcesDictionary.Keys
		  For i As Integer=0 To k.LastIndex
		    ImagesFileList_PopupMenu.AddRow k(i).StringValue.Titlecase  // ImagesFileList_PopupMenu est un Objet menu contextuel de Window1 qui est un DesktopPopupMenu
		    ImagesFileList_PopupMenu.RowTagAt(i)=k(i).StringValue
		  Next
		  if ImagesFileList_PopupMenu.LastRowIndex>-1 then ImagesFileList_PopupMenu.SelectedRowIndex=0
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Function loadFromResource(resName as String) As FolderItem
		  Var path As String=imageResourcesDictionary.Lookup(resName.Lowercase, "")
		  If path.IsEmpty Then Return Nil
		  
		  Var f As FolderItem
		  Try
		    f=New FolderItem(path, FolderItem.PathModes.Native)
		  Catch
		    f=Nil
		  End Try
		  If f<>Nil Then
		    If f.Exists And Not f.IsFolder And f.IsReadable Then
		      Return f
		    End If
		  end if
		End Function
	#tag EndMethod

	#tag Method, Flags = &h1
		Protected Sub LoadImage()
		  //Charge les images avec OpenCV
		  Var my_FolderItem As FolderItem
		  my_FolderItem = SpecialFolder.Resource("images").Child("starry_night.jpeg") // ‚ö†Ô∏è Il faudra que je modifie cette obligation de mettre l'image √† plat dans le dossier ~/images  C'est nul
		  
		  If my_FolderItem <> Nil Then
		    // reference est un Porperties de la fen√™tre qui va concerver l'acc√®s √† la Matrice de l'image (type OpenCV.CVCMat)
		    // https://docs.opencv.org/5.x/d3/d63/classcv_1_1Mat.html#details
		    // reference sera utiliser pour manipuler l'image ult√©rieurement
		    reference=openCV.Codecs.imread(my_FolderItem.NativePath, openCV.ImReadModes.Unchanged) // üî¥ important
		    //reference=openCV.Codecs.imread(f.NativePath, openCV.ImReadModes.Grayscale) // j'ai test√© en nuances de gris pour voir
		  End If
		  If reference=Nil Then
		    Label_ImageName.TextColor = color.RGB(255, 30, 0) // &cFF0000
		    Label_ImageName.Text = "No image loaded!"
		    Slider_Resize.Enabled=False
		    bBlur.Enabled=False
		  Else
		    Label_ImageName.TextColor = color.RGB(255, 255, 0)
		    Label_ImageName.Text="Loaded Image " + my_FolderItem.Name + ", Width = " +  reference.Width.ToString + _
		    ", Height = " + reference.Height.ToString
		    Slider_Resize.Enabled=True
		    bBlur.Enabled=True
		  End If
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h1
		Protected Sub myLoadImage(a_FolderItem As FolderItem)
		  
		  If a_FolderItem <> Nil Then
		    
		    reference_org = openCV.Codecs.imread( a_FolderItem.NativePath, openCV.ImReadModes.Unchanged) // üî¥ important
		    reference = reference_org // garde la Matrice originale de l'image dans reference_org
		    
		    //reference=openCV.Codecs.imread(f.NativePath, openCV.ImReadModes.Grayscale) // j'ai test√© en nuances de gris pour voir
		    
		  End If
		  
		  
		  If reference = Nil Then
		    Label_ImageName.TextColor = color.RGB(255, 30, 0) // &cFF0000
		    Label_ImageName.Text = "No image loaded!"
		    Slider_Resize.Enabled=False
		    bBlur.Enabled=False
		    
		    Return // pas la peine de continuer / ‚ö†Ô∏è  il faudrait peut-√™tre disabler d'autres boutons A VERIFIER 
		  End If
		  
		  
		  Label_ImageName.Text = "Loaded Image " + a_FolderItem.Name + ", Width = " +  reference.Width.ToString + _
		  ", Height = " + reference.Height.ToString
		  Slider_Resize.Enabled=True
		  bBlur.Enabled=True
		  
		  currentImage =  reference.image // will refresh the DesktopCanvas and show the image in it
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub m_Contours(imageMat As openCV.CVCMat)
		  // Mon Code
		  
		  If imageMat=Nil Then Return // car pas d'image en reference (qui a √©t√© charg√© par  la M√©thod "LoadImage()"
		  
		  Var reference2 As openCV.CVCMat
		  
		  
		  // convert to grayscale - ‚ñ∂Ô∏è Probablement plus efficace pour rep√©rer les Hedges (contours)
		  Var grayMAT As openCV.CVCMat
		  grayMAT = openCV.imgProc.CVCCvtColor(imageMat, openCV.ColorConversionCodes.Rgb2gray, 0)
		  
		  // apply gaussian blur -  ‚ñ∂Ô∏è l√† c'est plus √©tonnant de faire un flou avant d√©tection des Hedges ?!
		  Var blurSize As New openCV.CVCSize(0, 0)
		  Var blurMat As openCV.CVCMat
		  blurMat = openCV.imgProc.CVCGaussianBlur(grayMAT, blurSize, 3.0, 3.0, openCV.BorderTypes.Default)
		  
		  
		  // Apply Canny Edge Detection
		  reference2 = openCV.imgProc.CVCCanny(blurMat, threshold1, threshold2, 3, False)
		  
		  
		  // ‚ñ∂Ô∏è Maintenant je le mets √† l'√©chelle en fonction du Slider de Zoom
		  Var scale As Double  // Je sais que √ßa tiens en 1 ligne mais c'est plus clair en 2
		  scale = Slider_Resize.Value / 100 // j'ajoute ce facteur der√©duction de Zoom (pour l'instant l'image ne pas pas √™tre zoom plus que la taille du DesktopCanvas - √† √©tudier)
		  Var scaledSize As  openCV.CVCSize // Je sais que √ßa tiens en 1 ligne mais c'est plus clair en 2
		  scaledSize = New openCV.CVCSize (reference2.Width*scale, reference2.Height*Scale)
		  
		  // DOC :  openCV.imgProc.CVCresize(source as CVCMat, dest as CVCMat, dSize as CVCSize, fx as double, fy as double, interpolation as interpolationFlags)
		  openCV.imgProc.CVCresize(reference2, reference2, scaledSize, 0.0, 0.0, openCV.InterpolationFlags.Area)
		  
		  
		  
		  
		  
		  currentImage=reference2.image // j'ajoute cette ligne  qui existait dans le bouton Blurr mais qui semble avoir √©t√© oubli√©e ici
		  
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h1
		Protected Sub Show(title as String, image as openCV.CVCMat)
		  openCV.HighGui.imgShow(title, image)
		  openCV.HighGui.waitKey(0)
		  openCV.HighGui.DestroyAllWindows
		End Sub
	#tag EndMethod

	#tag Method, Flags = &h21
		Private Sub showTime(start as Double, lbl as DesktopLabel)
		  Var t As Double=System.Microseconds-start
		  t=t/1000
		  lbl.Text="Elapsed: "+t.ToString("#,##0.000")+"ms"
		  
		  
		End Sub
	#tag EndMethod


	#tag Property, Flags = &h21
		#tag Note
			
			// Argument added by Michel for choosing the right WebCam (not only the default)
		#tag EndNote
		Private camNo As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h0
		CamSwitch_Flag As Boolean = True
	#tag EndProperty

	#tag Property, Flags = &h21
		Private Cpt_Ticks As Integer
	#tag EndProperty

	#tag ComputedProperty, Flags = &h0
		#tag Getter
			Get
			  Return mcurrentImage
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  rects_Pair.RemoveAll
			  mcurrentImage = value
			  Canvas_Image.Refresh
			  
			End Set
		#tag EndSetter
		currentImage As Picture
	#tag EndComputedProperty

	#tag ComputedProperty, Flags = &h21
		#tag Getter
			Get
			  Return mcurrentVideo_Image
			End Get
		#tag EndGetter
		#tag Setter
			Set
			  rects_Video().RemoveAll
			  mcurrentVideo_Image = value
			  Canvas_Video.Refresh
			End Set
		#tag EndSetter
		Private current_Video_Picture As Picture
	#tag EndComputedProperty

	#tag Property, Flags = &h21
		Private facteurZoom As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h21
		Private imageResourcesDictionary As Dictionary
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mcurrentImage As Picture
	#tag EndProperty

	#tag Property, Flags = &h21
		Private mcurrentVideo_Image As Picture
	#tag EndProperty

	#tag Property, Flags = &h21
		Private pFirstTimeCameraLaunch_Flag As Boolean = True
	#tag EndProperty

	#tag Property, Flags = &h21
		Private rects_Pair() As Pair
	#tag EndProperty

	#tag Property, Flags = &h21
		Private rects_Video() As Pair
	#tag EndProperty

	#tag Property, Flags = &h21
		Private reference As openCV.CVCMat
	#tag EndProperty

	#tag Property, Flags = &h21
		Private reference2 As openCV.CVCMat
	#tag EndProperty

	#tag Property, Flags = &h21
		Private reference_org As openCV.CVCMat
	#tag EndProperty

	#tag Property, Flags = &h21
		#tag Note
			// Pour scaler l'image dans le Canvas
		#tag EndNote
		Private ScaleImage As Double
	#tag EndProperty

	#tag Property, Flags = &h21
		Private threshold1 As Double
	#tag EndProperty

	#tag Property, Flags = &h21
		Private threshold2 As Double
	#tag EndProperty

	#tag Property, Flags = &h0
		videoStream As openCV.CVCVideoCapture = nil
	#tag EndProperty

	#tag Property, Flags = &h0
		videoStream0 As openCV.CVCVideoCapture = nil
	#tag EndProperty

	#tag Property, Flags = &h0
		videoStream1 As openCV.CVCVideoCapture = nil
	#tag EndProperty

	#tag Property, Flags = &h1
		Protected xZoom As Integer = 0
	#tag EndProperty

	#tag Property, Flags = &h1
		Protected yZoom As Integer = 0
	#tag EndProperty


#tag EndWindowCode

#tag Events bLoad
	#tag Event
		Sub Pressed()
		  Var f As FolderItem
		  // f = Folderitem.ShowOpenFileDialog(FileTypeGroup1.Jpeg)
		  f = Folderitem.ShowOpenFileDialog("")
		  
		  If f Is Nil Then
		    // user cancelled
		    Return
		  End If
		  
		  
		  
		  myLoadImage(f)
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events bBlur
	#tag Event
		Sub Pressed()
		  // Marche bien, interesssant
		  
		  If reference=Nil Then Return
		  
		  Var blurSize As New openCV.CVCSize(0, 0) // la doc n'est pas prolixe 0,0 doit vouloir dire la taille par d√©faut
		  
		  //openCV.imgProc.CVCGaussianBlur(reference, reference, blurSize, 3.0, 3.0, openCV.BorderTypes.Default)
		  reference2=openCV.imgProc.CVCGaussianBlur(reference, blurSize, 3.0, 3.0, openCV.BorderTypes.Default) //üî¥
		  currentImage=reference2.image
		  
		  
		  //La doc :
		  //Blurs an image Using a Gaussian filter.
		  //
		  //The Function convolves the source image With the specified Gaussian kernel. In-place filtering Is supported.
		  //
		  //Parameters
		  //src    Input image; the image can have any number Of channels, which are processed independently, but the depth should be CV_8U, CV_16U, CV_16S, CV_32F Or CV_64F.
		  //dst    output image Of the same size And type As src.
		  //ksize    Gaussian kernel size. ksize.width And ksize.height can differ but they both must be positive And odd. Or, they can be zero's and then they are computed from sigma.
		  //sigmaX    Gaussian kernel standard deviation In X direction.
		  //sigmaY    Gaussian kernel standard deviation In Y direction; If sigmaY Is zero, it Is set To be equal To sigmaX, If both sigmas are zeros, they are computed from ksize.width And ksize.height, respectively (see getGaussianKernel For details); To fully control the result regardless Of possible future modifications Of all this semantics, it Is recommended To specify all Of ksize, sigmaX, And sigmaY.
		  //borderType    pixel extrapolation method, see BorderTypes. BORDER_WRAP Is Not supported.
		  //
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Button_Ma_Video
	#tag Event
		Sub Pressed()
		  //  ‚ö†Ô∏èPENSER A DEPLIER LES + POUR VOIR TOUT LE CODE ‚ö†Ô∏è
		  
		  Var videoStream As openCV.CVCVideoCapture=openCV.CVCVideoCapture.Create(camNo) // üé¶ ‚ö†Ô∏è üöß ouverture de la WebCam (Attention car je crois que cette ligne peut poser un pb si la cam√©ra est d√©j√† ouvert ‚ö†Ô∏è v√©rifier
		  
		  #If True // juste pour pouvoir r√©duire plier le code et le d√©plier si besoin (car Toujours Vrai)
		    If videoStream=Nil Then
		      MessageBox "Cannot connect to video stream"
		      Return
		    End If
		    If Not videoStream.isOpened Then
		      MessageBox "Cannot open video stream from camera"
		      Return
		    End If
		    
		    Var fdata As FolderItem=SpecialFolder.Resource("data") 
		    If fdata<>Nil And fdata.Exists And fdata.IsFolder Then // si le dossier "data" est bien pr√©sent...
		      fdata=fdata.Child("haarcascades")                            // ... v√©rifier sur le sous-dossier "haarcascades" existe
		    Else
		      fdata=Nil
		    End If
		    If fdata=Nil Or Not fdata.Exists Or Not fdata.IsFolder Then
		      MessageBox "Cannot access data"
		      Return
		    End If
		    
		    
		    Var faces_RectVector As New openCV.CVCRectVector // il faut que je comprenne vraiment ce qu'est un vecteur
		    Var eyes_RectVector As New openCV.CVCRectVector // Inutilis√©e (il faudra tester)
		    
		    Var faceCascade As New openCV.CVCCascadeClassifier // Def : Un CascadeClassifier utilise un fichier XML qui contient les informations n√©cessaires √† la d√©tection de l'objet, notamment les caract√©ristiques de Haar, les param√®tres de d√©tection et les poids associ√©s
		    Var eyeCascade As New openCV.CVCCascadeClassifier
		    
		  #EndIf
		  
		  //  ----- Lecture des 2 pre-trained classifier files -----------------------
		  
		  #If True // load pre-trained classifiers (toujours True, c'est pour pouvoir r√©duire visiblement le code ici
		    
		    
		    Var Faces_pre_trained_classifier_Flag As Boolean
		    Var Eyes_pre_trained_classifier_Flag As Boolean
		    
		    Faces_pre_trained_classifier_Flag = faceCascade.Load(fdata.Child("haarcascade_frontalface_default.xml")) // il faudra regarder bien ce fichier 
		    // It is a pre-trained classifier file for detecting human üî∏frontalüî∏ faces using the Haar feature-based cascade classifiers algorithm  in images and videos
		    // The file contains the information necessary for the classifier to perform detection, including the features used for detection, the number of stages used in the classifier, and the weights assigned to each feature.
		    //   The "haarcascade_frontalface_default.xml" file is one of t 
		    
		    
		    Eyes_pre_trained_classifier_Flag = eyeCascade.Load(fdata.Child("haarcascade_eye.xml"))
		    // "haarcascade_eye.xml" is another pre-trained classifier file for object detection using the Haar feature-based cascade classifiers algorithm in OpenCV. This file is specifically designed for detecting human eyes in images and videos.
		    //Similar to the "haarcascade_frontalface_default.xml" file, "haarcascade_eye.xml" contains the information necessary for the CascadeClassifier class to detect eyes. It includes the features used for detection, the number of stages used in the classifier, and the weights assigned to each feature.
		    //By using the "haarcascade_eye.xml" file with OpenCV's CascadeClassifier class, it is possible to perform eye detection in real-time applications such as video surveillance or facial recognition.he most commonly used classifier files for face detection in OpenCV. However, there are other pre-trained classifier files available for detecting other objects such as eyes, noses, and full-body profiles.
		    
		  #EndIf
		  
		  If Not ( Faces_pre_trained_classifier_Flag) OR Not( Eyes_pre_trained_classifier_Flag) Then // si l'un des 2 fichiers n'a pas pu √™tre charg√©
		    MessageBox "Cannot load classifiers"
		    Return
		    
		  End If
		  
		  //  ----------------------------
		  
		  // detect faces üî¥‚ö†Ô∏è Ici c'est interressant pour moi
		  Var cSize As New openCV.CVCSize(0, 0)
		  #If False // ‚ñ∂Ô∏è Ce code permet au programme de choisir quel partie du code va √™tre execut√©e. Ici ca saute ou pas tout le test (que je peut r√©duire visuellement du coup
		    
		    Var frame_Mat As New openCV.CVCMat
		    If videoStream.read(frame_Mat) Then // VideoRead
		      Var gray_Mat As openCV.CVCMat = openCV.imgProc.CVCCvtColor(frame_Mat, openCV.ColorConversionCodes.Rgb2gray_Mat, 0) // Conversion RGB2gray
		      currentImage = gray_Mat.image // l'image que le Canvas_Images va afficher
		      
		      //  üßîüèºd√©tection de Visages ici - Voir tout en bas pour l'explication üßîüèº     ‚ú¥Ô∏è1Ô∏è‚É£
		      faceCascade.DetectMultiScale(gray_Mat, faces_RectVector, 1.1, 3, 0, cSize, cSize) 
		      
		      Var faces_Cpt As Integer = faces_RectVector.Count
		      For i As UInteger = 0 To nf - 1      // üî¥ TRES BIZARRE j'ai renomm√© nf et le compilateur de proteste pas ?? üî¥ entier non sign√© = 0 et 4 294 967 295 (2^32 - 1) 
		        Var roiRect As openCV.CVCRect  = faces_RectVector.RowAt(i)  // ROI = r√©gion of Interrest. Les visages qui ont √©t√© d√©tect√© √† la ligne (a) sont pris 1 par 1
		        Var roigray_Mat As openCV.CVCMat=gray_Mat.Roi(roiRect) // c'est √©tonnant car les visages ont √©t√© extraits de la version d√©j√† gris de l'image (gray_Mat), pourquoi transformer √† nouveau gris. A tester
		        Var roiSrc As openCV.CVCMat = frame_Mat.Roi(roiRect)       // Le frame va servir √† faire le rectangle d'encadrement je suppose...
		        
		        System.DebugLog "roiRect("+i.toString+")=" + roiRect.toString // ecriture dans le fen√™tre de Debug
		        
		        
		        Var point1 As openCV.CVCPoint = roiRect.LeftTop                  // point en haut √† gauche du rectangle d'encadrement
		        System.DebugLog "point1:" + point1.toString
		        //point1.x=roiRect.x
		        //point1.y=roiRect.y
		        Var Point2 As openCV.CVCPoint = roiRect.RightBottom
		        'Point2.x=roiRect.Width
		        'Point2.y=roiRect.Height
		        System.DebugLog "point2:" + point2.toString
		        //point2.x=roiRect.x+roiRect.width
		        //point2.y=roiRect.y+roiRect.height
		        
		        
		        Var scalarColor As cvcScalar = Color.Green.toScalar // on va faire des rectangles verts üü©
		        'scalarColor.v0=255   // Bleu
		        'scalarColor.v1=0        // Vert
		        'scalarColor.v2=0       // Rouge
		        'scalarColor.v3=255  // alpha channel value (transparency)
		        openCV.imgProc.Rectangle(frame_Mat, point1, point2, scalarColor, 2, openCV.LineTypes.lineAA, -1)
		        
		        // üëÅÔ∏è detect eyes in face ROI üëÅÔ∏è
		        eyeCascade.DetectMultiScale(roigray_Mat, eyes_RectVector, 1.1, 3, 0, cSize, cSize)
		        
		        Var eyes_Cpt As Integer=eyes_RectVector.count
		        For j As Integer=0 To ne-1
		          Var roiRectE As openCV.CVCRect =eyes_RectVector.RowAt(i) // On va au eyes_RectVector suivant 
		          System.DebugLog "roiRectE("+i.toString+", "+j.toString+")="+roiRectE.toString
		          Var Point1e As openCV.CVCPoint=roiRectE.LeftTop
		          System.DebugLog "point1e:"+point1e.toString
		          //point1.x=roiRect.x
		          //point1.y=roiRect.y
		          Var point2e As openCV.CVCPoint=roiRectE.RightBottom
		          System.DebugLog "point2e:"+point2e.toString
		          //point2.x=roiRect.x+roiRect.width
		          //point2.y=roiRect.y+roiRect.height
		          Var scalarColorE As CVCScalar=Color.yellow.toScalar
		          'scalarColor.v0=0
		          'scalarColor.v1=0
		          'scalarColor.v2=255
		          'scalarColor.v3=255
		          
		          openCV.imgProc.Rectangle(roiSrc, Point1e, Point2e, scalarColorE, 1, openCV.LineTypes.Line4, 10)
		        Next
		      Next
		      currentImage=frame_Mat.image
		      //openCV.HighGui.imgShow("Object Detection", frame_Mat)
		    End If
		    
		    'openCV.HighGui.waitKey(0)
		    'openCV.HighGui.DestroyAllWindows
		    
		    //  ----------------------------
		    
		    
		  #Else
		    Var frame_Mat As New openCV.CVCMat
		    If videoStream.read ( frame_Mat ) Then             // Lecture de l'image de la WebCam
		      
		      Var gray_Mat As openCV.CVCMat = openCV.imgProc.CVCCvtColor ( frame_Mat , openCV.ColorConversionCodes.Rgb2gray , 0)
		      faceCascade.DetectMultiScale ( gray_Mat, faces_RectVector , 1.1 , 3 , 0 , cSize , cSize )  //ChatGPT sit faces = face_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=5)
		      
		      Var faces_Cpt2 As Integer=faces_RectVector.Count-1
		      System.DebugLog ( Str(faces_Cpt2-1) + " Visages d√©tect√©s")
		      For i As UInteger=0 To faces_Cpt2-1
		        Var roiRect As CVCRectStructure = faces_RectVector.RowAts( i )
		        System.DebugLog ( "roiRect(" + Str( i ) + ")=" + Str( roiRect ) )
		        
		        // # Dessiner un rectangle autour de chaque visage d√©tect√©
		        // for (x, y, w, h) in faces:
		        // cv2.rectangle(img, (x, y), (x+w, y+h), (0, 255, 0), 2)
		        
		      Next
		      ScaleImage = 1
		      currentImage = frame_Mat.image
		    End If
		    
		  #EndIf
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  // ‚ú¥Ô∏è1Ô∏è‚É£ faces_RectVector: une variable de sortie qui contiendra les coordonn√©es des rectangles de d√©tection de visages. Cette variable doit √™tre une liste vide.
		  // 1.1: le facteur d'√©chelle utilis√© pour l'agrandissement de l'image lors de la d√©tection de visages. Une valeur de 1.1 signifie que l'image sera agrandie de 10% √† chaque √©tape de la d√©tection de visages.
		  // 3: le nombre minimum de voisins requis pour un rectangle de d√©tection de visage pour √™tre accept√©. Cela aide √† √©liminer les faux positifs et √† augmenter la pr√©cision de la d√©tection.
		  // 0: un param√®tre obsol√®te qui n'est plus utilis√©. Il doit √™tre d√©fini sur 0.
		  // cSize: la taille minimale d'un rectangle de d√©tection de visage. Tout rectangle de d√©tection de visage dont la taille est inf√©rieure √† cette valeur sera ignor√©.
		  // cSize: la taille maximale d'un rectangle de d√©tection de visage. Tout rectangle de d√©tection de visage dont la taille est sup√©rieure √† cette valeur sera ignor√©.
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Canvas_Image
	#tag Event
		Sub Paint(g As Graphics, areas() As Rect)
		  // il faut que l'image rentre dans le g (Graphics) de DesktopCanvas_Image
		  
		  If currentImage = Nil Then Return // ‚ö†Ô∏è on peut faire un test sur une seule ligne de cette mani√®re
		  
		  // ScaleImage = Min(g.Width/currentImage.Width, g.Height/currentImage.Height) // Fonction min() int√©ressante
		  // If s>1.0 Then s=1.0 // initialement : If s>1
		  
		  
		  // reference2= New openCV.CVCMat // une nouvelle Matrice d'image en plus de reference
		  
		  // Var scaledCVCSize As New openCV.CVCSize ( reference.Width * ScaleImage  ,  reference.Height * ScaleImage )
		  // openCV.imgProc.CVCresize(reference, reference2, scaledCVCSize, 0.0, 0.0, openCV.InterpolationFlags.Area)
		  
		  
		  Var w, h As Double // width et height
		  w = currentImage.Width * ScaleImage  // donc en fait inutile pour moi puisque j'ai mis s = 1
		  h = currentImage.Height * ScaleImage  // donc en fait inutile pour moi puisque j'ai mis s = 1
		  
		  // w = currentImage.Width * Slider_Resize.Value / 100 // ‚ñ∂Ô∏è Je pr√©f√®re que l'image reste avec le Zoom des curseurs
		  // h =  currentImage.Height * Slider_Resize.Value / 100
		  
		  
		  g.DrawPicture ( currentImage, 0, 0, w, h, xZoom, yZoom, currentImage.Width, currentImage.Height )
		  
		  
		  
		  // üëâ rects_Pair : Pair de(  couleur , rect ) - Va servir pour encadrer des objets ou des visages pour certaines actions
		  // dessine les rectangles sur les visages
		  If rects_Pair.Count > 0 Then // il faut qu'il y a des Pair de Rect pour les dessiner (couleur √† Gauche et rectangle √† droite)
		    For i As Integer = 0 To rects_Pair.LastIndex // on parcours tout le tableau de rects_Pair()
		      g.DrawingColor = rects_Pair(i).Left // le type de rects_Pair() et Pair, donc le Left et la Paire de Gauche (type Variant donc peut tout accepter y compris Color
		      Var leRect() As Rect = rects_Pair(i).Right //  et l'√©l√©ment de droite est donc un rectange
		      For j As Integer = 0 To LeRect().LastIndex
		        g.DrawRectangle ( leRect(j).Left * ScaleImage , leRect(j).Top * ScaleImage , leRect (j).width * ScaleImage , leRect(j).height * ScaleImage ) // dessine les rectangles de couleur
		      Next
		    Next
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events button_CVCFloatVector
	#tag Event
		Sub Pressed()
		  If False Then
		    //Test int vector: is int32 vector
		    Var v As New openCV.CVCIntVector
		    v.Add 1
		    v.Add 10
		    Var n As Integer=v.Count
		    Var x As Integer=v.rowAt(0)
		    Var x1 As Integer=v.rowAt(1)
		    Var mref As New MemoryBlock(8)
		    mref.Int32Value(0)=x
		    mref.Int32Value(4)=x1
		    Var m As MemoryBlock=v.Data
		    Var mx1 As Integer=m.Int32Value(0)
		    Var mx2 As Integer=m.Int32Value(4)
		    
		    Break
		  End If
		  
		  If False Then
		    //Test float vector: is single vector
		    Var v As New openCV.CVCFloatVector
		    v.Add 99.2
		    v.Add 10.0
		    Var n As Integer=v.Count
		    Var x As Single=v.RowAt(0) //fails
		    Var x1 As Single=v.RowAt(1) //fails
		    Var mref As New MemoryBlock(8)
		    mref.SingleValue(0)=99.2
		    mref.SingleValue(4)=10.0
		    Var m As MemoryBlock=v.Data
		    Var mx1 As Single=m.SingleValue(0)
		    Var mx2 As Single=m.SingleValue(4)
		    
		    Break
		  End If
		  If False Then
		    //test new widht and height CVSize
		    Var s As New openCV.CVCSize(32.3, 25.75)
		    Var w As Integer=s.Width
		    Var h As Integer=s.Height
		    Break
		  End If
		  If False Then
		    //Test uchart vector: is uInt8 vector
		    Var v As New openCV.CVCUCharVector
		    v.Add 1  //Fails there is not the relative function
		    v.Add 255//Fails there is not the relative function
		    Var n As Integer=v.Count
		    Var x As UInt8=v.rowAt(0)
		    Var x1 As UInt8=v.rowAt(1)
		    Var mref As New MemoryBlock(2)
		    mref.UInt8Value(0)=x
		    mref.UInt8Value(1)=x1
		    Var m As MemoryBlock=v.Data
		    Var mx1 As Integer=m.UInt8Value(0)
		    Var mx2 As Integer=m.UInt8Value(1)
		    
		    Break
		  End If
		  If False Then  //Test the imEncode
		    If reference=Nil Then LoadImage
		    If reference=Nil Then Return
		    currentImage=Nil
		    Var m As MemoryBlock=openCV.Codecs.imEncode(".png", reference, CType(openCV.ImWriteFlags.PngCompression, Integer), 9) //without these params is faster,
		    Var p As Picture=Picture.FromData(m)
		    currentImage=p
		  End If
		  If True Then //test time (results in system.debug pane) image (mat to picture via file) vs image1 (mat to picture via memory)
		    rects_Pair.RemoveAll
		    If ImagesFileList_PopupMenu.RowCount=0 Then Return
		    Var f As FolderItem=loadFromResource(ImagesFileList_PopupMenu.RowTagAt(ImagesFileList_PopupMenu.SelectedRowIndex))
		    reference=openCV.Codecs.imread(f.NativePath, openCV.ImReadModes.Unchanged)
		    Var p2 As Picture
		    Var p1 As Picture
		    Var t As Double=System.Microseconds
		    p1=reference.image
		    t=System.Microseconds-t
		    System.DebugLog "via File:"+p1.Width.ToString+"x"+p1.Height.ToString+":"+t.ToString
		    t=System.Microseconds
		    p2=reference.image1
		    t=System.Microseconds-t
		    System.DebugLog "via Memory:"+p2.Width.ToString+"x"+p2.Height.ToString+":"+t.ToString
		    t=System.Microseconds
		    currentImage=p2
		  End If
		  If False Then
		    If reference=Nil Then LoadImage
		    Var p As Picture=reference.image
		    Var m As MemoryBlock=p.ToData(Picture.Formats.PNG)
		    Var result As openCV.CVCMat=openCV.Codecs.imdecode(m, openCV.ImReadModes.Color)
		    currentImage=result.image
		  End If
		  If False Then
		    #If False
		      //CVCRect as Object
		      Var v As New openCV.CVCRectVector
		      Var r As New openCV.CVCRect(10, 20 , 30, 40)
		      v.Add r
		      Var rr As rect=r
		      Var r2 As New openCV.CVCRect(1000, 2000, 4000, 128)
		      v.Add r2
		      Var n As Integer=v.Count
		      //Still fails on getting the rect
		      Var r1 As openCV.CVCRect=v.RowAt(0)
		      Var r1a As openCV.CVCRect=v.RowAt(1)
		      Var r1c As openCV.CVCRect=v.RowAt(2)
		      Break
		    #Else
		      Var v As New openCV.CVCRectVector
		      Var r As CVCRectStructure
		      r.x=10
		      r.y=20
		      r.width=30
		      r.height=40
		      v.Add r
		      Var xr As Rect=New rect(1000, 2000, 4000, 128)
		      
		      v.Add xr
		      Var n As Integer=v.Count
		      Var vr1 As CVCRectStructure=v.RowAts(0)
		      Var vr2 As CVCRectStructure=v.RowAts(1)
		      Var rr As rect=vr2.toRect
		      Break
		    #EndIf
		  End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events bFaces
	#tag Event
		Sub Pressed()
		  rects_Pair.RemoveAll
		  
		  If ImagesFileList_PopupMenu.RowCount=0 Then Return
		  Var f As FolderItem=loadFromResource(ImagesFileList_PopupMenu.RowTagAt(ImagesFileList_PopupMenu.SelectedRowIndex))
		  If f=Nil Then Return
		  
		  Var src As openCV.CVCMat=openCV.Codecs.imread(f.NativePath, openCV.ImReadModes.Unchanged)
		  
		  currentImage=src.image
		  Var startTime As Double=System.Microseconds
		  
		  
		  Var faceCascade As New openCV.CVCCascadeClassifier
		  Var eyeCascade As New openCV.CVCCascadeClassifier
		  Var fdata As FolderItem=SpecialFolder.Resource("data")
		  If fdata<>Nil And fdata.Exists And fdata.IsFolder Then
		    fdata=fdata.Child("haarcascades")
		  Else
		    fdata=Nil
		  End If
		  If fdata=Nil Or Not fdata.Exists Or Not fdata.IsFolder Then
		    MessageBox "Cannot access data"
		    Return
		  End If
		  // load pre-trained classifiers
		  Var ok As Boolean=faceCascade.Load(fdata.Child("haarcascade_frontalface_default.xml"))
		  ok=ok And eyeCascade.Load(fdata.Child("haarcascade_eye.xml"))
		  If Not ok Then
		    MessageBox "Cannot load classifiers"
		    Return
		  End If
		  
		  Var cSize As New openCV.CVCSize(0, 0)
		  Var gray As openCV.CVCMat=openCV.imgProc.CVCCvtColor(src, openCV.ColorConversionCodes.Rgb2gray, 0)
		  currentImage=gray.image
		  
		  Var faces As New openCV.CVCRectVector
		  faceCascade.DetectMultiScale(gray, faces, 1.1, 3, 0, cSize, cSize)
		  Var n As Integer=faces.Count-1
		  System.DebugLog "Faces:"+faces.Count.toString
		  Var rr() As Rect
		  Var ee() As Rect
		  For i As Integer=0 To n
		    
		    Var roiRect As openCV.CVCRect =faces.RowAt(i)
		    Var r As rect=roiRect
		    Var roiGray As openCV.CVCMat=gray.Roi(roiRect)
		    Var roiSrc As openCV.CVCMat=src.Roi(roiRect)
		    Var point1 As openCV.CVCPoint=roiRect.LeftTop
		    System.DebugLog "point1:"+point1.toString
		    Var Point2 As openCV.CVCPoint=roiRect.RightBottom
		    System.DebugLog "point2:"+point2.toString
		    
		    Var scalarColor As cvcScalar=Color.Green.toScalar
		    openCV.imgProc.Rectangle2(roiSrc, roiRect, scalarColor, -1)
		    //openCV.imgProc.Rectangle(gray, point1, point2, scalarColor, 2, openCV.LineTypes.lineAA, -1)
		    rr.Add r
		    
		    Var eyes As New openCV.CVCRectVector
		    eyeCascade.DetectMultiScale(roiGray, eyes, 1.1, 3, 0, cSize, cSize)
		    Var ne As Integer=eyes.count-1
		    System.DebugLog "eyes of face("+i.toString+"):"+eyes.Count.toString
		    For j As Integer=0 To ne
		      Var roiRectE As openCV.CVCRect =eyes.RowAt(j)
		      Var re As rect=roiRectE
		      Var Point1e As openCV.CVCPoint=roiRectE.LeftTop
		      System.DebugLog "point1e:"+point1e.toString
		      Var point2e As openCV.CVCPoint=roiRectE.RightBottom
		      System.DebugLog "point2e:"+point2e.toString
		      Var scalarColorE As CVCScalar=Color.blue.toScalar
		      openCV.imgProc.Rectangle2(roiSrc, roiRectE, scalarColorE, 4, openCV.LineTypes.lineAA)
		      //openCV.imgProc.Rectangle(roiSrc, Point1e, Point2e, scalarColorE, 1, openCV.LineTypes.Line4, 10)
		      re.Offset(r.Left, r.Top)
		      //ee.Add re
		    Next
		  Next
		  showTime(startTime, lblFaces) // atetn
		  currentImage=src.image
		  rects_Pair.Add Color.Yellow:rr
		  rects_Pair.Add Color.Red:ee
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events bSobel
	#tag Event
		Sub Pressed()
		  Var n As Integer=Runtime.ObjectCount
		  Var mn As Integer=Runtime.MemoryUsed // interessant üî¥
		  rects_Pair.RemoveAll
		  If ImagesFileList_PopupMenu.RowCount=0 Then Return
		  If True Then
		    Var f As FolderItem=loadFromResource(ImagesFileList_PopupMenu.RowTagAt(ImagesFileList_PopupMenu.SelectedRowIndex))
		    If f=Nil Then Return
		    Var image As openCV.CVCMat=openCV.Codecs.imread(f.NativePath, openCV.ImReadModes.Unchanged) // C'est une imRead dont une image et pas une video
		    
		    currentImage=image.image
		    Var ksize As Integer=sobelParam(0).Value*2-1 //ksize must be odd
		    ksize=min(ksize, 31) //max ksize value is 31
		    ksize=max(ksize, 1) //min ksize is 1
		    Var scale As Integer=sobelParam(1).Value
		    Var delta As Integer=sobelParam(2).Value
		    
		    
		    Var depth As openCV.depths=openCV.Depths.CV16S
		    Var src As New openCV.CVCMat
		    openCV.imgProc.CVCGaussianBlur(image, src, New openCV.CVCSize(3, 3), 0, 0, openCV.BorderTypes.Default)
		    
		    Var srcGray As New openCV.CVCMat
		    openCV.imgProc.CVCCvtColor(src, srcGray, openCV.ColorConversionCodes.Bgr2gray, 0)
		    
		    Var gradX As New openCV.CVCMat
		    Var gradY As New openCV.CVCMat
		    Var absGradX As New openCV.CVCMat
		    Var absGradY As New openCV.CVCMat
		    
		    openCV.imgProc.CVCSobel(srcGray, gradX, CType(depth, Integer), 1, 0, ksize, scale, delta, openCV.BorderTypes.Default)
		    
		    openCV.imgProc.CVCSobel(srcGray, gradY, CType(depth, Integer), 1, 0, ksize, scale, delta, openCV.BorderTypes.Default)
		    
		    openCV.Core.convertScaleAbs(gradX, absGradX, 2, 2)
		    
		    openCV.Core.convertScaleAbs(gradY, absGradY, 2, 2)
		    
		    Var grad As New openCV.CVCMat
		    openCV.Core.addWeighted(absGradX, .5, absGradY, .5, .5, grad, 0)
		    currentImage=grad.image
		  End If
		  n=Runtime.ObjectCount-n
		  mn=Runtime.MemoryUsed-mn
		  System.DebugLog mn.ToString+" ("+n.ToString+")"
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events sobelParam
	#tag Event
		Sub ValueChanged(index as Integer)
		  tSobleParam(index).Text=me.Value.ToString
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Slider_Resize
	#tag Event
		Sub ValueChanged()
		  
		  // ‚ñ∂Ô∏è Maintenant je le mets √† l'√©chelle en fonction du Slider de Zoom
		  ScaleImage = Slider_Resize.Value / 100 // j'ajoute ce facteur der√©duction de Zoom (pour l'instant l'image ne pas pas √™tre zoom plus que la taille du DesktopCanvas - √† √©tudier)
		  Canvas_Image.Refresh
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Button_Gray
	#tag Event
		Sub Pressed()
		  If reference=Nil Then Return // car pas d'image en reference (qui a √©t√© charg√© par  la M√©thod "LoadImage()"
		  
		  reference2= New openCV.CVCMat // une nouvelle Matrice d'image en plus de reference
		  
		  
		  
		  // convert to grayscale
		  reference2=openCV.imgProc.CVCCvtColor(reference, openCV.ColorConversionCodes.Rgb2gray, 0)
		  
		  
		  currentImage=reference2.image // j'ajoute cette ligne  qui existait dans le bouton Blurr mais qui semble avoir √©t√© oubli√©e ici
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Slider_threshold1
	#tag Event
		Sub ValueChanged()
		  // par d√©faut 85 pour threshold1
		  
		  threshold1 = me.Value
		  Label_Threshold1.Text = threshold1.ToString
		  
		  m_Contours (reference) // J'appelle mon code
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Slider_threshold2
	#tag Event
		Sub ValueChanged()
		  //  par d√©faut 175 pour threshold2
		  
		  threshold2 = me.Value
		  Label_Threshold2.Text = threshold2.ToString
		  
		  
		  m_Contours (reference) // J'appelle mon code
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Slider_Scroll_Offset
	#tag Event
		Sub ValueChanged()
		  If reference=Nil Then Return // car pas d'image en reference (qui a √©t√© charg√© par  la M√©thod "LoadImage()"
		  // reference type is : openCV.CVCMat
		  
		  reference2= New openCV.CVCMat // une nouvelle Matrice d'image en plus de reference
		  
		  // ‚ñ∂Ô∏è Maintenant je le mets √† l'√©chelle en fonction du Slider de Zoom
		  Var scale As Double  // Je sais que √ßa tiens en 1 ligne mais c'est plus clair en 2
		  scale = Slider_Resize.Value / 100 // j'ajoute ce facteur der√©duction de Zoom (pour l'instant l'image ne pas pas √™tre zoom plus que la taille du DesktopCanvas - √† √©tudier)
		  Var scaledSize As  openCV.CVCSize // Je sais que √ßa tiens en 1 ligne mais c'est plus clair en 2
		  scaledSize = New openCV.CVCSize (reference.Width*scale, reference.Height*Scale)
		  
		  
		  
		  // DOC :  openCV.imgProc.CVCresize(source as CVCMat, dest as CVCMat, dSize as CVCSize, fx as double, fy as double, interpolation as interpolationFlags)
		  openCV.imgProc.CVCresize(reference, reference2, scaledSize, 0.0, 0.0, openCV.InterpolationFlags.Area)
		  
		  
		  currentImage=reference2.image // j'ajoute cette ligne  qui existait dans le bouton Blurr mais qui semble avoir √©t√© oubli√©e ici
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Canvas_Video
	#tag Event
		Sub Paint(g As Graphics, areas() As Rect)
		  // g est le Graphics
		  
		  If current_Video_Picture = Nil Then Return // affect√©e lors du Load de l'image
		  
		  // il faut que l'image rentre dans le g (Graphics) de DesktopCanvas_Image
		  Var s As Double
		  s = Min(g.Width/current_Video_Picture.Width, g.Height/current_Video_Picture.Height)  // Fonction min() int√©ressante
		  
		  Var w, h As Double // width et height
		  
		  w=current_Video_Picture.Width*s
		  h=current_Video_Picture.Height*s
		  
		  // w = currentImage.Width * Slider_Resize.Value / 100 // ‚ñ∂Ô∏è Je pr√©f√®re que l'image reste avec le Zoom des curseurs
		  // h =  currentImage.Height * Slider_Resize.Value / 100
		  
		  
		  // affiche la Picture √† oa bonne dimension
		  // Image as Picture, X as Integer, Y as Integer [,DestWidth as Integer, DestHeight as Integer, SourceX as Integer, SourceY as Integer, SourceWidth as Integer, SourceHeight as Integer]
		  //  Draws the picture at the specified location.  - ‚ñ∂Ô∏èLes 3 premiers param√®tres sont obligatoires
		  // apr√®s ces 3 premiers param√®tres ‚ñ∂Ô∏è  The optional parameters are used to copy a portion of the picture and for scaling the picture :
		  // DestWidth and DestHeight are used to change the scaling of the picture when it is drawn and default to the Width and Height of the picture.
		  // SourceX and SourceY default to 0 and are used to determine the upper-left coordinate you wish to copy from. SourceWidth and SourceHeight 
		  // default to the Width and Height of the picture and are used to indicate the portion of the picture you wish to copy.
		  
		  
		  g.DrawPicture (current_Video_Picture, 0, 0, w, h, 0, 0, current_Video_Picture.Width, current_Video_Picture.Height)
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Timer_Video_‚è∞
	#tag Event
		Sub Action()
		  // üî¥ √©tudier VAR DIM et STATIC en d√©tails üî¥
		  
		  Static cpt_CreateCall As Integer = 0 // Ceci ne sera execut√© qu'une seule fois car c'est la d√©finition de Static : cf doc : A Static variable is equivalent to a local variable declared by the Var statement but its value is retained between several calls of the method it is declared in. Also, all the instances of a given class share the same Static values. .. note:: Whenever you assign an initial value to a Static variable using the equal sign, the assignment will occur only once when the method is called for the very first time.
		  
		  Static videoStream As openCV.CVCVideoCapture
		  
		  
		  if BevelButton_CameraActivated.Value then
		    
		    cpt_ticks = System.Ticks
		    If (videoStream = Nil) or (Not videoStream.isOpened ) Then
		      
		      // J'ai mis du temps √† comprendre que c'est ainsi qu'il faut faire pour choisir la WebCam en ouvrant les 2 canaux (ou plus si autres Webcam).
		      videoStream0 = openCV.CVCVideoCapture.Create(0) // üé¶ Ouverture de la WebCam (param√®tre ajout√© par Michel dans le Fork de la version initiale de Friolator
		      videoStream1 = openCV.CVCVideoCapture.Create(1) // üé¶ Ouverture de la WebCam (param√®tre ajout√© par Michel dans le Fork de la version initiale de Friolator
		      
		      videoStream = videoStream1   // üî¥üî¥ √† priori il peut y avoir plus d'une seule Webcam (la 0) mais il peut ne pas y avoir de camNo est dans ce cas prenons la webcam 0 
		      
		      
		      cpt_CreateCall = cpt_CreateCall + 1
		      Window_myConsole.TextArea_Console.Text = Window_myConsole.TextArea_Console.Text + "Create() calls : " + Str(cpt_CreateCall) + Chr(13)  // pour suivre combien de fois il y a le Create jusqu'√† ce qu'on autorise la cam√©ra
		      Return
		    End If
		    System.DebugLog(" Ticks 'Create' = " + Str(System.Ticks - cpt_ticks))
		    
		    Window_myConsole.TextArea_Console.Text = Window_myConsole.TextArea_Console.Text + "camNo = " + Str(camNo) + Chr(13) // pour suivre combien de fois il y a le Create jusqu'√† ce qu'on autorise la cam√©ra
		    
		    // if CamSwitch_Flag then 
		    // if camNo = 1 then
		    // videoStream = videoStream1
		    // Else                                                  
		    // videoStream = videoStream0   // √† priori il peut y avoir plus d'une seule Webcam (la 0) mais il peut ne pas y avoir de camNo est dans ce cas prenons la webcam 0 
		    // End If
		    // CamSwitch_Flag = False
		    // End If
		    
		    
		    
		    Var frameMat As New openCV.CVCMat
		    
		    // 4Ticks
		    cpt_ticks = System.Ticks
		    If videoStream.read(frameMat) Then // LECTURE DE LA WEBCAM
		      current_Video_Picture = frameMat.image // the Picture will be Painted in the Canvas_Video
		    End If
		    System.DebugLog(" Ticks 'Read' = " + Str(System.Ticks - cpt_ticks))
		    
		    
		    Static myStr As String // üî¥ par forc√©ment n√©cessaire de faire un Static ici üî¥ !!
		    myStr =  RadioGroup_ImageAction.SelectedItem.Caption
		    
		    Select Case myStr
		      
		    Case "None"
		      reference = frameMat
		      Canvas_Image.Refresh
		      
		    Case "Blur"
		      reference = frameMat 
		      bBlur.Press 
		      
		      
		    Case "Gray"
		      reference = frameMat 
		      Button_Gray.Press 
		      
		    Case "Canny Edge Detection"
		      reference = frameMat 
		      m_Contours(frameMat)
		      
		    Case "Abs Diff" // bug
		      
		      // Var pLogo As FolderItem =   SpecialFolder.Resource("coresample").Child("logo.jpg")
		      // If pLogo<>Nil  then
		      // reference = openCV.Codecs.imRead(pLogo.NativePath, openCV.ImReadModes.Unchanged)  // on prend le logo
		      // End If
		      
		      If  reference_org<> nil then
		        // openCV.Core.AbsDiff (frameMat , reference_org , reference)
		        Dim tempoMat As New openCV.CVCMat
		        openCV.Core.AbsDiff (frameMat , reference_org , tempoMat)
		        currentImage=tempoMat.image
		        Canvas_Image.Refresh // √† laisser ? üî¥
		        
		        // Else 
		        // MessageBox("At least one of the 2 images could not be loaded")
		        
		      End If
		      
		      
		    End Select
		  End If
		  
		  // ‚ö†Ô∏è ‚ö†Ô∏è STATIC ‚ö†Ô∏è ‚ö†Ô∏è   A Static variable is equivalent to a local variable declared by the Var statement but its value is retained _
		  // between several calls of the method it is declared in. Also, all the instances of a given class share the same Static values. _
		  // .. note:: Whenever you assign an initial value to a Static variable using the equal sign, _
		  // the assignment will occur only once when the method is called for the very first time.
		  
		  
		  //______________-
		  
		  
		  // la doc : https://docs.opencv.org/4.7.0/d5/dc4/tutorial_video_input_psnr_ssim.html
		  
		  // https://www.geeksforgeeks.org/python-opencv-capture-video-from-camera/
		  
		  // >> https://learnopencv.com/read-write-and-display-a-video-using-opencv-cpp-python/
		  
		  // Var f As  FolderItem
		  // f=SpecialFolder.Resource("Films").Child("Megamind.avi") // ‚ö†Ô∏è Il faudra que je modifie cette obligation de mettre l'image √† plat dans le dossier ~/images  C'est nul
		  
		  // la doc : https://docs.opencv.org/4.7.0/d5/dc4/tutorial_video_input_psnr_ssim.html
		  // Ce code marche mais je dois cliquer plusieurs fois sur le bouton
		  
		  // 
		  // if CheckBox_Camera.Value then
		  // 
		  // 
		  // // videoStream=openCV.CVCVideoCapture.Create() // 13 ticks üî¥üî¥ il semble qu'il le faille √† chaque fois or cela coute 13 ticks donc freq faible
		  // 
		  // 
		  // 
		  // If videoStream = Nil Then // j'ai d√©plac√© le Create √† l'open de la fen√™tre (Event Handler Open"
		  // 
		  // Window_myConsole.TextArea_Console.Text = "Cannot connect to video stream"+ chr(13)
		  // videoStream = openCV.CVCVideoCapture.Create()
		  // 
		  // Return
		  // End If
		  // 
		  // Window_myConsole.TextArea_Console.Text = Window_myConsole.TextArea_Console.Text  + Str( videoStream.mHandle)  + " videoStream.isOpened  = " + Str(videoStream.isOpened) + chr(13)
		  // 
		  // //0 Ticks
		  // If Not videoStream.isOpened Then  // Le Handle est bon mais le statut isOpened reste False et donc cela ne marche pas - apparemment cela prend du temps d'ouvrir le stream (2 sec sur mon mac), c'est pour cela qu'il faut cliquer plusieurs fois sur le bouton
		  // Label_Video_Msg.FontSize =  10
		  // Label_Video_Msg.TextColor = Color.Red
		  // Label_Video_Msg.Text =  "Cannot open video stream from camera yet" + Chr(13) +"Try clicking again on the button please"
		  // 
		  // Window_myConsole.TextArea_Console.Text = "Cannot open video stream from camera yet -  VideoStream.Create Handle at WindowOpen : " + Str(videoStream.mHandle) _
		  // + "  + videoStream.isOpened = " + Str(videoStream.isOpened)  + chr(13)
		  // videoStream = openCV.CVCVideoCapture.Create()
		  // 
		  // Return
		  // End If
		  // 
		  // 
		  // // 0 Ticks
		  // Var frame As New openCV.CVCMat
		  // 
		  // // 4Ticks
		  // If videoStream.read(frame) Then
		  // //show("VideoFrame", frame)
		  // current_Video_Picture = frame.image
		  // Label_Video_Msg.Text = ""
		  // 
		  // End If
		  // 
		  // Else
		  // Label_Video_Msg.Text =  " Camera checkBox unchecked"
		  // 
		  // 
		  // End If
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events BevelButton_CameraActivated
	#tag Event
		Sub Pressed()
		  // Il faut que le bouton soit en mode ToogleButton
		  
		  // ‚ñ∂Ô∏è L'essentiel du code est dans le Timer_Video_‚è∞
		  
		  
		  if Me.Value Then
		    RadioGroup_ImageAction.Enabled = True // active the options when Webcam is active
		  Else
		    RadioGroup_ImageAction.Enabled = False
		  End If
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Button_V_ORG
	#tag Event
		Sub Pressed()
		  Var videoStream As openCV.CVCVideoCapture=openCV.CVCVideoCapture.Create(camNo) // Create ici
		  If videoStream=Nil Then
		    MessageBox "Cannot connect to video stream"
		    Return
		  End If
		  If Not videoStream.isOpened Then
		    MessageBox "Cannot open video stream from camera"
		    Return
		  End If
		  
		  Var faces As New openCV.CVCRectVector
		  Var eyes As New openCV.CVCRectVector
		  
		  Var faceCascade As New openCV.CVCCascadeClassifier
		  Var eyeCascade As New openCV.CVCCascadeClassifier
		  Var fdata As FolderItem=SpecialFolder.Resource("data")
		  If fdata<>Nil And fdata.Exists And fdata.IsFolder Then
		    fdata=fdata.Child("haarcascades")
		  Else
		    fdata=Nil
		  End If
		  If fdata=Nil Or Not fdata.Exists Or Not fdata.IsFolder Then
		    MessageBox "Cannot access data"
		    Return
		  End If
		  
		  // load pre-trained classifiers
		  Var ok As Boolean=faceCascade.Load(fdata.Child("haarcascade_frontalface_default.xml"))
		  ok=ok And eyeCascade.Load(fdata.Child("haarcascade_eye.xml"))
		  If Not ok Then
		    MessageBox "Cannot load classifiers"
		    Return
		  End If
		  
		  // detect faces üî¥‚ö†Ô∏è Ici c'est interressant pour moi
		  Var cSize As New openCV.CVCSize(0, 0)
		  #If False
		    Var frame As New openCV.CVCMat
		    If videoStream.read(frame) Then
		      Var gray As openCV.CVCMat=openCV.imgProc.CVCCvtColor(frame, openCV.ColorConversionCodes.Rgb2gray, 0)
		      currentImage=gray.image
		      faceCascade.DetectMultiScale(gray, faces, 1.1, 3, 0, cSize, cSize)
		      Var nf As Integer=faces.Count
		      For i As UInteger=0 To nf-1
		        Var roiRect As openCV.CVCRect =faces.RowAt(i)
		        Var roiGray As openCV.CVCMat=gray.Roi(roiRect)
		        Var roiSrc As openCV.CVCMat=frame.Roi(roiRect)
		        System.DebugLog "roiRect("+i.toString+")="+roiRect.toString
		        Var point1 As openCV.CVCPoint=roiRect.LeftTop
		        System.DebugLog "point1:"+point1.toString
		        //point1.x=roiRect.x
		        //point1.y=roiRect.y
		        Var Point2 As openCV.CVCPoint=roiRect.RightBottom
		        'Point2.x=roiRect.Width
		        'Point2.y=roiRect.Height
		        System.DebugLog "point2:"+point2.toString
		        //point2.x=roiRect.x+roiRect.width
		        //point2.y=roiRect.y+roiRect.height
		        
		        Var scalarColor As cvcScalar=Color.Green.toScalar
		        'scalarColor.v0=255
		        'scalarColor.v1=0
		        'scalarColor.v2=0
		        'scalarColor.v3=255
		        openCV.imgProc.Rectangle(frame, point1, point2, scalarColor, 2, openCV.LineTypes.lineAA, -1)
		        
		        // detect eyes in face ROI
		        eyeCascade.DetectMultiScale(roiGray, eyes, 1.1, 3, 0, cSize, cSize)
		        Var ne As Integer=eyes.count
		        For j As Integer=0 To ne-1
		          Var roiRectE As openCV.CVCRect =eyes.RowAt(i)
		          System.DebugLog "roiRectE("+i.toString+", "+j.toString+")="+roiRectE.toString
		          Var Point1e As openCV.CVCPoint=roiRectE.LeftTop
		          System.DebugLog "point1e:"+point1e.toString
		          //point1.x=roiRect.x
		          //point1.y=roiRect.y
		          Var point2e As openCV.CVCPoint=roiRectE.RightBottom
		          System.DebugLog "point2e:"+point2e.toString
		          //point2.x=roiRect.x+roiRect.width
		          //point2.y=roiRect.y+roiRect.height
		          Var scalarColorE As CVCScalar=Color.yellow.toScalar
		          'scalarColor.v0=0
		          'scalarColor.v1=0
		          'scalarColor.v2=255
		          'scalarColor.v3=255
		          
		          openCV.imgProc.Rectangle(roiSrc, Point1e, Point2e, scalarColorE, 1, openCV.LineTypes.Line4, 10)
		        Next
		      Next
		      currentImage=frame.image
		      //openCV.HighGui.imgShow("Object Detection", frame)
		    End If
		    
		    'openCV.HighGui.waitKey(0)
		    'openCV.HighGui.DestroyAllWindows
		  #Else
		    Var frame As New openCV.CVCMat
		    If videoStream.read(frame) Then
		      Var gray As openCV.CVCMat=openCV.imgProc.CVCCvtColor(frame, openCV.ColorConversionCodes.Rgb2gray, 0)
		      faceCascade.DetectMultiScale(gray, faces, 1.1, 3, 0, cSize, cSize)
		      Var nf As Integer=faces.Count-1
		      For i As UInteger=0 To nf-1
		        Var roiRect As CVCRectStructure =faces.RowAts(i)
		        System.DebugLog "roiRect("+i.toString+")="+roiRect.toString
		      Next
		      currentImage=frame.image
		    End If
		    
		  #EndIf
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events Button_FacesFromFile
	#tag Event
		Sub Pressed()
		  //  ‚ö†Ô∏èPENSER A DEPLIER LES + POUR VOIR TOUT LE CODE ‚ö†Ô∏è
		  
		  //Var videoStream As openCV.CVCVideoCapture=openCV.CVCVideoCapture.Create // Create ici
		  
		  Var imageDeVisages As  openCV.CVCMat 
		  
		  Var f As  FolderItem
		  f=SpecialFolder.Resource("images").Child("Visage femme.jpg") 
		  
		  
		  If f <> Nil Then
		    
		    imageDeVisages = openCV.Codecs.imread( f.NativePath, openCV.ImReadModes.Unchanged) // üî¥ important
		    
		  End If
		  
		  
		  If imageDeVisages = Nil Then
		    Label_ImageName.TextColor = color.RGB(255, 30, 0) // &cFF0000
		    Label_ImageName.Text = "Visage femme.jpg NOT LOADED !!"
		    Slider_Resize.Enabled=False
		    bBlur.Enabled=False
		    
		    Return // pas la peine de continuer / ‚ö†Ô∏è  il faudrait peut-√™tre disabler d'autres boutons A VERIFIER 
		  End If
		  
		  
		  
		  #If True // juste pour pouvoir r√©duire plier le code et le d√©plier si besoin (car Toujours Vrai)
		    
		    
		    Var fdata As FolderItem=SpecialFolder.Resource("data") 
		    If fdata<>Nil And fdata.Exists And fdata.IsFolder Then // si le dossier "data" est bien pr√©sent...
		      fdata=fdata.Child("haarcascades")                            // ... v√©rifier sur le sous-dossier "haarcascades" existe
		    Else
		      fdata=Nil
		    End If
		    If fdata=Nil Or Not fdata.Exists Or Not fdata.IsFolder Then
		      MessageBox "Cannot access data"
		      Return
		    End If
		    
		    
		    Var faces_RectVector As New openCV.CVCRectVector // il faut que je comprenne vraiment ce qu'est un vecteur
		    Var eyes_RectVector As New openCV.CVCRectVector // Inutilis√©e (il faudra tester)
		    
		    Var faceCascade As New openCV.CVCCascadeClassifier // Def : Un CascadeClassifier utilise un fichier XML qui contient les informations n√©cessaires √† la d√©tection de l'objet, notamment les caract√©ristiques de Haar, les param√®tres de d√©tection et les poids associ√©s
		    Var eyeCascade As New openCV.CVCCascadeClassifier
		    
		  #EndIf
		  
		  //  ----- Lecture des 2 pre-trained classifier files -----------------------
		  
		  #If True // load pre-trained classifiers (toujours True, c'est pour pouvoir r√©duire visiblement le code ici
		    
		    
		    Var Faces_pre_trained_classifier_Flag As Boolean
		    Var Eyes_pre_trained_classifier_Flag As Boolean
		    
		    Faces_pre_trained_classifier_Flag = faceCascade.Load(fdata.Child("haarcascade_frontalface_default.xml")) // il faudra regarder bien ce fichier 
		    // It is a pre-trained classifier file for detecting human üî∏frontalüî∏ faces using the Haar feature-based cascade classifiers algorithm  in images and videos
		    // The file contains the information necessary for the classifier to perform detection, including the features used for detection, the number of stages used in the classifier, and the weights assigned to each feature.
		    //   The "haarcascade_frontalface_default.xml" file is one of t 
		    
		    
		    Eyes_pre_trained_classifier_Flag = eyeCascade.Load(fdata.Child("haarcascade_eye.xml"))
		    // "haarcascade_eye.xml" is another pre-trained classifier file for object detection using the Haar feature-based cascade classifiers algorithm in OpenCV. This file is specifically designed for detecting human eyes in images and videos.
		    //Similar to the "haarcascade_frontalface_default.xml" file, "haarcascade_eye.xml" contains the information necessary for the CascadeClassifier class to detect eyes. It includes the features used for detection, the number of stages used in the classifier, and the weights assigned to each feature.
		    //By using the "haarcascade_eye.xml" file with OpenCV's CascadeClassifier class, it is possible to perform eye detection in real-time applications such as video surveillance or facial recognition.he most commonly used classifier files for face detection in OpenCV. However, there are other pre-trained classifier files available for detecting other objects such as eyes, noses, and full-body profiles.
		    
		  #EndIf
		  
		  If Not ( Faces_pre_trained_classifier_Flag) OR Not( Eyes_pre_trained_classifier_Flag) Then // si l'un des 2 fichiers n'a pas pu √™tre charg√©
		    MessageBox "Cannot load classifiers"
		    Return
		    
		  End If
		  
		  //  ----------------------------
		  
		  // detect faces üî¥‚ö†Ô∏è Ici c'est interressant pour moi
		  Var cSize As New openCV.CVCSize(0, 0)
		  #If False // ‚ñ∂Ô∏è Ce code permet au programme de choisir quel partie du code va √™tre execut√©e. Ici ca saute ou pas tout le test (que je peut r√©duire visuellement du coup
		    
		    Var frame_Mat As New openCV.CVCMat
		    If videoStream.read(frame_Mat) Then // VideoRead
		      Var gray_Mat As openCV.CVCMat = openCV.imgProc.CVCCvtColor(frame_Mat, openCV.ColorConversionCodes.Rgb2gray_Mat, 0) // Conversion RGB2gray
		      currentImage = gray_Mat.image // l'image que le Canvas_Images va afficher
		      
		      //  üßîüèºd√©tection de Visages ici - Voir tout en bas pour l'explication üßîüèº     ‚ú¥Ô∏è1Ô∏è‚É£
		      faceCascade.DetectMultiScale(gray_Mat, faces_RectVector, 1.1, 3, 0, cSize, cSize) 
		      
		      Var faces_Cpt As Integer = faces_RectVector.Count
		      For i As UInteger = 0 To nf - 1      // üî¥ TRES BIZARRE j'ai renomm√© nf et le compilateur de proteste pas ?? üî¥ entier non sign√© = 0 et 4 294 967 295 (2^32 - 1) 
		        Var roiRect As openCV.CVCRect  = faces_RectVector.RowAt(i)  // ROI = r√©gion of Interrest. Les visages qui ont √©t√© d√©tect√© √† la ligne (a) sont pris 1 par 1
		        Var roigray_Mat As openCV.CVCMat=gray_Mat.Roi(roiRect) // c'est √©tonnant car les visages ont √©t√© extraits de la version d√©j√† gris de l'image (gray_Mat), pourquoi transformer √† nouveau gris. A tester
		        Var roiSrc As openCV.CVCMat = frame_Mat.Roi(roiRect)       // Le frame va servir √† faire le rectangle d'encadrement je suppose...
		        
		        System.DebugLog "roiRect("+i.toString+")=" + roiRect.toString // ecriture dans le fen√™tre de Debug
		        
		        
		        Var point1 As openCV.CVCPoint = roiRect.LeftTop                  // point en haut √† gauche du rectangle d'encadrement
		        System.DebugLog "point1:" + point1.toString
		        //point1.x=roiRect.x
		        //point1.y=roiRect.y
		        Var Point2 As openCV.CVCPoint = roiRect.RightBottom
		        'Point2.x=roiRect.Width
		        'Point2.y=roiRect.Height
		        System.DebugLog "point2:" + point2.toString
		        //point2.x=roiRect.x+roiRect.width
		        //point2.y=roiRect.y+roiRect.height
		        
		        
		        Var scalarColor As cvcScalar = Color.Green.toScalar // on va faire des rectangles verts üü©
		        'scalarColor.v0=255   // Bleu
		        'scalarColor.v1=0        // Vert
		        'scalarColor.v2=0       // Rouge
		        'scalarColor.v3=255  // alpha channel value (transparency)
		        openCV.imgProc.Rectangle(frame_Mat, point1, point2, scalarColor, 2, openCV.LineTypes.lineAA, -1)
		        
		        // üëÅÔ∏è detect eyes in face ROI üëÅÔ∏è
		        eyeCascade.DetectMultiScale(roigray_Mat, eyes_RectVector, 1.1, 3, 0, cSize, cSize)
		        
		        Var eyes_Cpt As Integer=eyes_RectVector.count
		        For j As Integer=0 To ne-1
		          Var roiRectE As openCV.CVCRect =eyes_RectVector.RowAt(i) // On va au eyes_RectVector suivant 
		          System.DebugLog "roiRectE("+i.toString+", "+j.toString+")="+roiRectE.toString
		          Var Point1e As openCV.CVCPoint=roiRectE.LeftTop
		          System.DebugLog "point1e:"+point1e.toString
		          //point1.x=roiRect.x
		          //point1.y=roiRect.y
		          Var point2e As openCV.CVCPoint=roiRectE.RightBottom
		          System.DebugLog "point2e:"+point2e.toString
		          //point2.x=roiRect.x+roiRect.width
		          //point2.y=roiRect.y+roiRect.height
		          Var scalarColorE As CVCScalar=Color.yellow.toScalar
		          'scalarColor.v0=0
		          'scalarColor.v1=0
		          'scalarColor.v2=255
		          'scalarColor.v3=255
		          
		          openCV.imgProc.Rectangle(roiSrc, Point1e, Point2e, scalarColorE, 1, openCV.LineTypes.Line4, 10)
		        Next
		      Next
		      currentImage=frame_Mat.image
		      //openCV.HighGui.imgShow("Object Detection", frame_Mat)
		    End If
		    
		    'openCV.HighGui.waitKey(0)
		    'openCV.HighGui.DestroyAllWindows
		    
		    //  ----------------------------
		    
		    
		  #Else
		    
		    
		    Var gray_Mat As openCV.CVCMat = openCV.imgProc.CVCCvtColor ( imageDeVisages , openCV.ColorConversionCodes.Rgb2gray , 0)
		    faceCascade.DetectMultiScale ( gray_Mat, faces_RectVector , 1.1 , 3 , 0 , cSize , cSize )  //ChatGPT sit faces = face_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=5)
		    
		    Var faces_Cpt2 As Integer=faces_RectVector.Count-1
		    System.DebugLog ( Str(faces_Cpt2-1) + " Visages d√©tect√©s")
		    For i As UInteger=0 To faces_Cpt2-1
		      Var roiRect As CVCRectStructure = faces_RectVector.RowAts( i )
		      System.DebugLog ( "roiRect(" + Str( i ) + ")=" + Str( roiRect ) )
		      
		      // # Dessiner un rectangle autour de chaque visage d√©tect√©
		      // for (x, y, w, h) in faces:
		      // cv2.rectangle(img, (x, y), (x+w, y+h), (0, 255, 0), 2)
		      
		    Next
		    ScaleImage = 1
		    currentImage = imageDeVisages.image
		    
		    
		  #EndIf
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  
		  // ‚ú¥Ô∏è1Ô∏è‚É£ faces_RectVector: une variable de sortie qui contiendra les coordonn√©es des rectangles de d√©tection de visages. Cette variable doit √™tre une liste vide.
		  // 1.1: le facteur d'√©chelle utilis√© pour l'agrandissement de l'image lors de la d√©tection de visages. Une valeur de 1.1 signifie que l'image sera agrandie de 10% √† chaque √©tape de la d√©tection de visages.
		  // 3: le nombre minimum de voisins requis pour un rectangle de d√©tection de visage pour √™tre accept√©. Cela aide √† √©liminer les faux positifs et √† augmenter la pr√©cision de la d√©tection.
		  // 0: un param√®tre obsol√®te qui n'est plus utilis√©. Il doit √™tre d√©fini sur 0.
		  // cSize: la taille minimale d'un rectangle de d√©tection de visage. Tout rectangle de d√©tection de visage dont la taille est inf√©rieure √† cette valeur sera ignor√©.
		  // cSize: la taille maximale d'un rectangle de d√©tection de visage. Tout rectangle de d√©tection de visage dont la taille est sup√©rieure √† cette valeur sera ignor√©.
		  
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag Events WebCam_Num
	#tag Event
		Sub SelectionChanged(button As DesktopRadioButton)
		  camNo = WebCam_Num.SelectedIndex // choix de radiobutton choisi (index 0)
		  
		  
		  Window_myConsole.TextArea_Console.Text = Window_myConsole.TextArea_Console.Text + "Swtich camNo = " + Str(camNo) + Chr(13) // pour suivre combien de fois il y a le Create jusqu'√† ce qu'on autorise la cam√©ra
		  
		  CamSwitch_Flag = True // Flag de changement
		  
		End Sub
	#tag EndEvent
#tag EndEvents
#tag ViewBehavior
	#tag ViewProperty
		Name="Name"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Interfaces"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Super"
		Visible=true
		Group="ID"
		InitialValue=""
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Width"
		Visible=true
		Group="Size"
		InitialValue="600"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Height"
		Visible=true
		Group="Size"
		InitialValue="400"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumWidth"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MinimumHeight"
		Visible=true
		Group="Size"
		InitialValue="64"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximumWidth"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MaximumHeight"
		Visible=true
		Group="Size"
		InitialValue="32000"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Type"
		Visible=true
		Group="Frame"
		InitialValue="0"
		Type="Types"
		EditorType="Enum"
		#tag EnumValues
			"0 - Document"
			"1 - Movable Modal"
			"2 - Modal Dialog"
			"3 - Floating Window"
			"4 - Plain Box"
			"5 - Shadowed Box"
			"6 - Rounded Window"
			"7 - Global Floating Window"
			"8 - Sheet Window"
			"9 - Metal Window"
			"11 - Modeless Dialog"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="Title"
		Visible=true
		Group="Frame"
		InitialValue="Untitled"
		Type="String"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasCloseButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasMaximizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasMinimizeButton"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasFullScreenButton"
		Visible=true
		Group="Frame"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Resizeable"
		Visible=true
		Group="Frame"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="Composite"
		Visible=false
		Group="OS X (Carbon)"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MacProcID"
		Visible=false
		Group="OS X (Carbon)"
		InitialValue="0"
		Type="Integer"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="FullScreen"
		Visible=false
		Group="Behavior"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="ImplicitInstance"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="DefaultLocation"
		Visible=true
		Group="Behavior"
		InitialValue="0"
		Type="Locations"
		EditorType="Enum"
		#tag EnumValues
			"0 - Default"
			"1 - Parent Window"
			"2 - Main Screen"
			"3 - Parent Window Screen"
			"4 - Stagger"
		#tag EndEnumValues
	#tag EndViewProperty
	#tag ViewProperty
		Name="Visible"
		Visible=true
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="HasBackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="False"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="BackgroundColor"
		Visible=true
		Group="Background"
		InitialValue="&hFFFFFF"
		Type="ColorGroup"
		EditorType="ColorGroup"
	#tag EndViewProperty
	#tag ViewProperty
		Name="Backdrop"
		Visible=true
		Group="Background"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBar"
		Visible=true
		Group="Menus"
		InitialValue=""
		Type="DesktopMenuBar"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="MenuBarVisible"
		Visible=true
		Group="Deprecated"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="currentImage"
		Visible=false
		Group="Behavior"
		InitialValue=""
		Type="Picture"
		EditorType=""
	#tag EndViewProperty
	#tag ViewProperty
		Name="CamSwitch_Flag"
		Visible=false
		Group="Behavior"
		InitialValue="True"
		Type="Boolean"
		EditorType=""
	#tag EndViewProperty
#tag EndViewBehavior
